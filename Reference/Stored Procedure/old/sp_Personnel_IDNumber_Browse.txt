CREATE PROCEDURE sp_Personnel_IDNumber_Browse

@IDNumber varchar(50), @Select int

AS

--Load
if @Select = 0
	SELECT     TOP 1 dbo.tbl_PersonnelProfileInformation_IDNumber.PK, dbo.tbl_PersonnelProfileInformation_IDNumber.ProfileKey, dbo.tbl_PersonnelProfileInformation_IDNumber.DateHired, dbo.tbl_PersonnelProfileInformation_IDNumber.LastModified,
                      dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber, dbo.tbl_PersonnelProfileInformation.LastName + ',  ' + dbo.tbl_PersonnelProfileInformation.FirstName + '  ' + dbo.tbl_PersonnelProfileInformation.MiddleName  AS EmployeeName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelAction.Division FROM dbo.tbl_PersonnelAction WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), getdate(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS Division,
                          (SELECT     TOP 1 dbo.tbl_PersonnelDepartment.DepartmentCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelDepartment ON dbo.tbl_PersonnelAction.Dept = dbo.tbl_PersonnelDepartment.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS DeptCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelDepartment.DepartmentName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelDepartment ON dbo.tbl_PersonnelAction.Dept = dbo.tbl_PersonnelDepartment.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND   (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS DeptName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelPosition.PositionCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelPosition ON dbo.tbl_PersonnelAction.Positions = dbo.tbl_PersonnelPosition.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND   (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS PostCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelPosition.PositionName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelPosition ON dbo.tbl_PersonnelAction.Positions = dbo.tbl_PersonnelPosition.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS PostName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelEmploymentStatus.StatusCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelEmploymentStatus ON dbo.tbl_PersonnelAction.EmpStatus = dbo.tbl_PersonnelEmploymentStatus.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS StatusCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelEmploymentStatus.StatusName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelEmploymentStatus ON dbo.tbl_PersonnelAction.EmpStatus = dbo.tbl_PersonnelEmploymentStatus.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS StatusName
	FROM         dbo.tbl_PersonnelProfileInformation_IDNumber LEFT OUTER JOIN
                      dbo.tbl_PersonnelProfileInformation ON dbo.tbl_PersonnelProfileInformation_IDNumber.ProfileKey = dbo.tbl_PersonnelProfileInformation.PK
	WHERE     (dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber = @IDNumber)
	ORDER BY dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber
else
--Home
if @Select = 1
	SELECT     TOP 1 dbo.tbl_PersonnelProfileInformation_IDNumber.PK, dbo.tbl_PersonnelProfileInformation_IDNumber.ProfileKey, dbo.tbl_PersonnelProfileInformation_IDNumber.DateHired, dbo.tbl_PersonnelProfileInformation_IDNumber.LastModified,
                      dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber, dbo.tbl_PersonnelProfileInformation.LastName + ',  ' + dbo.tbl_PersonnelProfileInformation.FirstName + '  ' + dbo.tbl_PersonnelProfileInformation.MiddleName  AS EmployeeName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelAction.Division FROM dbo.tbl_PersonnelAction WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), getdate(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS Division,
                          (SELECT     TOP 1 dbo.tbl_PersonnelDepartment.DepartmentCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelDepartment ON dbo.tbl_PersonnelAction.Dept = dbo.tbl_PersonnelDepartment.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS DeptCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelDepartment.DepartmentName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelDepartment ON dbo.tbl_PersonnelAction.Dept = dbo.tbl_PersonnelDepartment.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND   (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS DeptName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelPosition.PositionCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelPosition ON dbo.tbl_PersonnelAction.Positions = dbo.tbl_PersonnelPosition.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND   (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS PostCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelPosition.PositionName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelPosition ON dbo.tbl_PersonnelAction.Positions = dbo.tbl_PersonnelPosition.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS PostName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelEmploymentStatus.StatusCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelEmploymentStatus ON dbo.tbl_PersonnelAction.EmpStatus = dbo.tbl_PersonnelEmploymentStatus.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS StatusCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelEmploymentStatus.StatusName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelEmploymentStatus ON dbo.tbl_PersonnelAction.EmpStatus = dbo.tbl_PersonnelEmploymentStatus.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS StatusName
	FROM         dbo.tbl_PersonnelProfileInformation_IDNumber LEFT OUTER JOIN
                      dbo.tbl_PersonnelProfileInformation ON dbo.tbl_PersonnelProfileInformation_IDNumber.ProfileKey = dbo.tbl_PersonnelProfileInformation.PK
	ORDER BY dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber
else
--PageUp
if @Select = 2
	SELECT     TOP 1 dbo.tbl_PersonnelProfileInformation_IDNumber.PK, dbo.tbl_PersonnelProfileInformation_IDNumber.ProfileKey, dbo.tbl_PersonnelProfileInformation_IDNumber.DateHired, dbo.tbl_PersonnelProfileInformation_IDNumber.LastModified,
                      dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber, dbo.tbl_PersonnelProfileInformation.LastName + ',  ' + dbo.tbl_PersonnelProfileInformation.FirstName + '  ' + dbo.tbl_PersonnelProfileInformation.MiddleName  AS EmployeeName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelAction.Division FROM dbo.tbl_PersonnelAction WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), getdate(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS Division,
                          (SELECT     TOP 1 dbo.tbl_PersonnelDepartment.DepartmentCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelDepartment ON dbo.tbl_PersonnelAction.Dept = dbo.tbl_PersonnelDepartment.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS DeptCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelDepartment.DepartmentName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelDepartment ON dbo.tbl_PersonnelAction.Dept = dbo.tbl_PersonnelDepartment.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND   (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS DeptName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelPosition.PositionCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelPosition ON dbo.tbl_PersonnelAction.Positions = dbo.tbl_PersonnelPosition.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND   (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS PostCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelPosition.PositionName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelPosition ON dbo.tbl_PersonnelAction.Positions = dbo.tbl_PersonnelPosition.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS PostName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelEmploymentStatus.StatusCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelEmploymentStatus ON dbo.tbl_PersonnelAction.EmpStatus = dbo.tbl_PersonnelEmploymentStatus.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS StatusCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelEmploymentStatus.StatusName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelEmploymentStatus ON dbo.tbl_PersonnelAction.EmpStatus = dbo.tbl_PersonnelEmploymentStatus.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS StatusName
	FROM         dbo.tbl_PersonnelProfileInformation_IDNumber LEFT OUTER JOIN
                      dbo.tbl_PersonnelProfileInformation ON dbo.tbl_PersonnelProfileInformation_IDNumber.ProfileKey = dbo.tbl_PersonnelProfileInformation.PK
	WHERE     (dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber < @IDNumber)
	ORDER BY dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber DESC
else
--PageDown
if @Select = 3
	SELECT     TOP 1 dbo.tbl_PersonnelProfileInformation_IDNumber.PK, dbo.tbl_PersonnelProfileInformation_IDNumber.ProfileKey, dbo.tbl_PersonnelProfileInformation_IDNumber.DateHired, dbo.tbl_PersonnelProfileInformation_IDNumber.LastModified,
                      dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber, dbo.tbl_PersonnelProfileInformation.LastName + ',  ' + dbo.tbl_PersonnelProfileInformation.FirstName + '  ' + dbo.tbl_PersonnelProfileInformation.MiddleName  AS EmployeeName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelAction.Division FROM dbo.tbl_PersonnelAction WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), getdate(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS Division,
                          (SELECT     TOP 1 dbo.tbl_PersonnelDepartment.DepartmentCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelDepartment ON dbo.tbl_PersonnelAction.Dept = dbo.tbl_PersonnelDepartment.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS DeptCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelDepartment.DepartmentName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelDepartment ON dbo.tbl_PersonnelAction.Dept = dbo.tbl_PersonnelDepartment.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND   (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS DeptName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelPosition.PositionCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelPosition ON dbo.tbl_PersonnelAction.Positions = dbo.tbl_PersonnelPosition.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND   (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS PostCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelPosition.PositionName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelPosition ON dbo.tbl_PersonnelAction.Positions = dbo.tbl_PersonnelPosition.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS PostName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelEmploymentStatus.StatusCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelEmploymentStatus ON dbo.tbl_PersonnelAction.EmpStatus = dbo.tbl_PersonnelEmploymentStatus.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS StatusCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelEmploymentStatus.StatusName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelEmploymentStatus ON dbo.tbl_PersonnelAction.EmpStatus = dbo.tbl_PersonnelEmploymentStatus.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS StatusName
	FROM         dbo.tbl_PersonnelProfileInformation_IDNumber LEFT OUTER JOIN
                      dbo.tbl_PersonnelProfileInformation ON dbo.tbl_PersonnelProfileInformation_IDNumber.ProfileKey = dbo.tbl_PersonnelProfileInformation.PK
	WHERE     (dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber > @IDNumber)
	ORDER BY dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber
else
--End
if @Select = 4
	SELECT     TOP 1 dbo.tbl_PersonnelProfileInformation_IDNumber.PK, dbo.tbl_PersonnelProfileInformation_IDNumber.ProfileKey, dbo.tbl_PersonnelProfileInformation_IDNumber.DateHired, dbo.tbl_PersonnelProfileInformation_IDNumber.LastModified,
                      dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber, dbo.tbl_PersonnelProfileInformation.LastName + ',  ' + dbo.tbl_PersonnelProfileInformation.FirstName + '  ' + dbo.tbl_PersonnelProfileInformation.MiddleName  AS EmployeeName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelAction.Division FROM dbo.tbl_PersonnelAction WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), getdate(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS Division,
                          (SELECT     TOP 1 dbo.tbl_PersonnelDepartment.DepartmentCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelDepartment ON dbo.tbl_PersonnelAction.Dept = dbo.tbl_PersonnelDepartment.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS DeptCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelDepartment.DepartmentName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelDepartment ON dbo.tbl_PersonnelAction.Dept = dbo.tbl_PersonnelDepartment.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND   (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS DeptName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelPosition.PositionCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelPosition ON dbo.tbl_PersonnelAction.Positions = dbo.tbl_PersonnelPosition.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND   (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS PostCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelPosition.PositionName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelPosition ON dbo.tbl_PersonnelAction.Positions = dbo.tbl_PersonnelPosition.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102))  ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS PostName,
                          (SELECT     TOP 1 dbo.tbl_PersonnelEmploymentStatus.StatusCode FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelEmploymentStatus ON dbo.tbl_PersonnelAction.EmpStatus = dbo.tbl_PersonnelEmploymentStatus.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS StatusCode,
                          (SELECT     TOP 1 dbo.tbl_PersonnelEmploymentStatus.StatusName FROM dbo.tbl_PersonnelAction LEFT OUTER JOIN dbo.tbl_PersonnelEmploymentStatus ON dbo.tbl_PersonnelAction.EmpStatus = dbo.tbl_PersonnelEmploymentStatus.PK WHERE  (dbo.tbl_PersonnelAction.EmpPK = dbo.tbl_PersonnelProfileInformation_IDNumber.PK) AND  (dbo.tbl_PersonnelAction.EffectivityDate <= CONVERT(DATETIME, CONVERT(char(6), GETDATE(), 12), 102)) ORDER BY dbo.tbl_PersonnelAction.EffectivityDate DESC) AS StatusName
	FROM         dbo.tbl_PersonnelProfileInformation_IDNumber LEFT OUTER JOIN
                      dbo.tbl_PersonnelProfileInformation ON dbo.tbl_PersonnelProfileInformation_IDNumber.ProfileKey = dbo.tbl_PersonnelProfileInformation.PK
	ORDER BY dbo.tbl_PersonnelProfileInformation_IDNumber.IDNumber DESC
GO
